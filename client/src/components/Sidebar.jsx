import { useState } from "react";
import { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle } from "@/components/ui/alert-dialog";
import { Menu, X, ChevronLeft, ChevronRight, LogOut, User } from "lucide-react";
import { useAuthStore } from "../store/authStore";
import { useNavigate } from "react-router-dom";
import { useQueryClient } from "@tanstack/react-query";

const Sidebar = ({ navItems, activeNav, setActiveNav }) => {
  const { logout, user } = useAuthStore();
  const navigate = useNavigate();
  const queryClient = useQueryClient();
  const [isMobileMenuOpen, setIsMobileMenuOpen] = useState(false);
  const [isCollapsed, setIsCollapsed] = useState(false);
  const [logoutOpen, setLogoutOpen] = useState(false);

  // Check if current page is Account (not accounting)
  const location = window.location.pathname;
  const isAccountActive = location === '/landlord/account' || location === '/tenant/account';

  const handleLogout = () => {
    // Clear all cached queries to prevent showing stale data on next login
    queryClient.clear();
    console.log('ðŸ§¹ Cleared all React Query cache on logout');
    
    logout();
    navigate("/login");
  };

  const handleNavClick = (id) => {
    setActiveNav(id);
    setIsMobileMenuOpen(false);
  };

  // const sidebarWidth = isCollapsed ? "w-[70px]" : "w-[220px]";

  return (
    <>
      {/* Mobile menu button */}
      <button
        onClick={() => setIsMobileMenuOpen(!isMobileMenuOpen)}
        className="lg:hidden fixed bottom-4 right-4 z-50 p-3 bg-gray-800 text-white rounded-full shadow-lg cursor-pointer w-14 h-14 flex items-center justify-center"
      >
        {isMobileMenuOpen ? <X size={24} /> : <Menu size={24} />}
      </button>

      {/* Overlay for mobile */}
      {isMobileMenuOpen && (
        <div
          className="lg:hidden fixed inset-0 z-30"
          style={{ backgroundColor: 'rgba(0, 0, 0, 0.6)' }}
          onClick={() => setIsMobileMenuOpen(false)}
        />
      )}

      {/* Sidebar container */}
      <div
        className={`
          bg-primary dark:bg-gray-950 dark:border-r dark:border-gray-800 fixed lg:static inset-y-0 left-0 z-40 flex flex-col justify-between
          text-white dark:text-gray-100 transform transition-all duration-300 ease-in-out
          ${isMobileMenuOpen
            ? "translate-x-0"
            : "-translate-x-full lg:translate-x-0"
          }
        `}
        style={{
          width: isCollapsed ? "70px" : "220px",
        }}
      >
        {/* Top section */}
        <div className="p-4 pr-0">
          {isCollapsed ? (
            <div className="mb-8 flex items-center justify-center">
              <button
                onClick={() => setIsCollapsed(false)}
                className="hidden lg:block p-2 hover:bg-gray-700 rounded-lg transition"
              >
                <ChevronRight size={20} />
              </button>
            </div>
          ) : (
            <div className="mb-8 flex items-center justify-between">
              <div className="whitespace-nowrap">
                <svg width="146" height="32" viewBox="0 0 146 32" fill="none" xmlns="http://www.w3.org/2000/svg" className="h-8 w-auto">
                  <path d="M8.93487 25.3281V15.7329C8.93487 15.5683 9.31172 15.0193 9.43797 14.8587L18.0193 5.99608C18.4574 5.6288 19.0944 5.58098 19.6071 5.78948C22.0824 7.35234 24.6247 8.83677 27.0656 10.4494C28.3606 11.3044 29.4548 11.687 29.5906 13.4316C29.8948 17.29 29.3668 21.552 29.5753 25.4524C29.4969 26.6843 28.4333 27.57 27.2282 27.0899C24.5003 25.1827 21.5238 23.5701 18.8189 21.6381C18.3484 21.3014 17.7745 20.8576 17.6061 20.2799C17.3766 19.4956 17.3823 16.1365 17.6061 15.3158C17.916 14.1777 19.7505 13.9691 20.5023 14.8127C21.2541 15.6563 20.6974 17.9155 20.8868 18.9733L26.1914 22.3898V13.8505L19.4617 9.60577L19.1881 9.54838L12.2787 16.785L12.2289 28.7637C12.0223 29.9229 10.7789 30.5944 9.73065 29.9937L0.996241 23.9469C-0.264375 23.0402 0.116296 21.7069 0.125861 20.4176C0.148816 17.2135 -0.162991 13.3207 0.118209 10.2179C0.200465 9.30161 0.7533 8.76217 1.3597 8.15386C3.34722 6.15868 5.54517 4.21706 7.6073 2.2831C8.85262 1.11621 9.8722 -0.745061 11.7736 0.314698C12.8659 0.923008 15.2513 2.3424 16.1389 3.10948C17.4378 4.23045 16.5081 6.38632 14.8611 6.1319C14.6488 6.09938 14.423 5.94443 14.2318 5.84496C13.1624 5.29212 12.0893 4.41409 11.041 3.79431L10.8612 3.78474L4.75513 9.53307L3.44478 10.8855V21.4984L3.70877 21.7853L8.93296 25.3281H8.93487Z" fill="#FEFFF8"/>
                  <path d="M36.1057 19.0841V25.3738C36.1057 26.0376 34.9445 26.7128 34.3152 26.7128C33.6858 26.7128 32.5247 26.0376 32.5247 25.3738V15.4113H40.8325C41.3471 15.4113 42.5599 14.6882 42.9463 14.3114C46.0261 11.3176 42.8296 6.09919 38.6767 7.65248C37.3893 8.13454 36.1057 9.74522 36.1057 11.1397V13.6648H32.5247V10.497C32.5247 8.18427 34.8833 5.43158 36.8976 4.49616C43.8932 1.24419 50.7931 9.28038 46.4603 15.7135C43.9754 19.4036 40.119 19.1836 36.1038 19.0822L36.1057 19.0841Z" fill="#FEFFF8"/>
                  <path d="M101.191 5.12769V8.61686H93.1126V14.0343H97.2885C97.5888 14.0343 98.1761 14.3556 98.3942 14.5814C99.2282 15.4479 99.0121 16.9821 97.9179 17.5081C97.8299 17.5502 97.432 17.7071 97.3822 17.7071H93.1145V23.1245H99.5859C99.8614 23.1245 100.437 23.4248 100.646 23.6256C101.277 24.2378 101.375 25.1694 100.904 25.9097C100.747 26.1584 100.145 26.7055 99.8633 26.7055H89.5354V5.12769H101.195H101.191Z" fill="#FEFFF8"/>
                  <path d="M76.4055 26.7053V31.8472H72.8245V23.2161C73.1765 23.2658 73.5285 23.1702 73.8651 23.1587C76.0554 23.0764 78.9057 23.4724 81.0328 23.1166C86.1671 22.2615 84.6215 14.1335 79.4298 15.3616C78.1558 15.6639 76.4055 17.2057 76.4055 18.5792V21.4715H72.9622C72.9527 21.4715 72.8245 21.3433 72.8245 21.3338V18.5792C72.8245 15.9642 75.2482 13.1407 77.5992 12.2455C84.5278 9.60946 90.6816 17.4677 86.4311 23.5585C85.4402 24.9779 83.0012 26.7053 81.2241 26.7053H76.4055Z" fill="#FEFFF8"/>
                  <path d="M141.949 17.4312C141.018 15.3232 138.062 14.6307 136.228 15.9774C134.039 17.5842 133.963 20.708 136.123 22.3876C138.068 23.8988 140.995 22.445 142.41 23.5353C143.623 24.4688 143.126 26.5272 141.536 26.7051C138.087 27.0934 135.009 26.4889 132.721 23.7668C128.05 18.2117 133.494 10.1946 140.446 12.0004C143.944 12.9091 146.628 16.7617 145.869 20.3848C145.829 20.5722 145.833 20.9376 145.655 20.9969L137.888 20.9854C136.503 20.84 135.74 19.2523 136.626 18.1179C136.817 17.8731 137.481 17.4293 137.773 17.4293H141.949V17.4312Z" fill="#FEFFF8"/>
                  <path d="M112.023 22.5732V26.4296C107.593 27.7476 102.729 24.6238 102.38 19.9601C101.761 11.6466 112.538 8.55912 116.444 15.9927C117.569 18.1333 117.559 22.4029 117.351 24.8266C117.129 27.4033 114.001 27.1833 113.768 25.0982C113.422 22.0127 115.055 16.8153 111.155 15.4992C106.916 14.0702 103.941 19.5967 107.431 22.3456C108.779 23.4091 110.551 23.3422 112.023 22.5732Z" fill="#FEFFF8"/>
                  <path d="M62.984 11.7652C67.8008 11.3463 71.837 15.5815 71.0547 20.3887C70.0293 26.6841 62.106 28.9605 57.9569 24.0864C54.0392 19.4839 56.9775 12.2894 62.984 11.7672V11.7652ZM63.3532 15.2525C57.8765 15.6332 59.0549 24.2949 64.4952 23.0993C69.2221 22.0606 68.2293 14.9139 63.3532 15.2525Z" fill="#FEFFF8"/>
                  <path d="M129.649 11.7385V15.2277L123.646 15.2373C122.105 15.4324 122.215 17.2841 123.449 17.4333C124.566 17.5691 125.458 17.3109 126.644 17.726C130.835 19.1989 130.548 25.4197 126.323 26.5465C125.23 26.8372 121.818 26.8162 120.601 26.7091C118.522 26.5254 118.52 23.5623 120.259 23.2371C121.659 22.975 123.518 23.4035 124.987 23.1931C126.456 22.9827 126.449 21.3242 125.427 21.0564C124.7 20.8651 123.528 21.0679 122.648 20.8976C118.839 20.1592 117.676 15.1856 120.699 12.7505C121.205 12.343 122.445 11.7385 123.084 11.7385H129.647H129.649Z" fill="#FEFFF8"/>
                  <path d="M55.3841 11.7385V15.1818C55.3841 15.3635 54.6706 15.3138 54.4621 15.3616C49.9935 16.3678 51.8605 22.0205 51.4301 25.1825C51.1546 27.2083 48.0557 27.2504 47.8548 25.0104C47.7114 23.4112 47.7496 20.6585 47.8548 19.0344C48.0978 15.2602 51.5468 11.7385 55.386 11.7385H55.3841Z" fill="#FEFFF8"/>
                </svg>
              </div>
              <button
                onClick={() => setIsCollapsed(true)}
                className="hidden lg:block p-2 hover:bg-gray-700 rounded-lg transition"
              >
                <ChevronLeft size={20} />
              </button>
            </div>
          )}

          {/* Nav Items */}
          <nav className="flex-1 space-y-2 overflow-y-auto">
            {navItems.map((item, index) => {
              const activeIndex = navItems.findIndex((nav) => nav.id === activeNav);
              const isActive = activeNav === item.id;
              const isBeforeActive = activeIndex !== -1 && index === activeIndex - 1;
              const isAfterActive = activeIndex !== -1 && index === activeIndex + 1;

              return (
                <button
                  key={item.id}
                  onClick={() => handleNavClick(item.id)}
                  className={`w-full flex items-center ${
                    isCollapsed 
                      ? "justify-center px-0" 
                      : "space-x-3"
                    } ${
                    !isCollapsed && isActive 
                      ? "pl-3 pr-0" 
                      : !isCollapsed 
                      ? "px-3" 
                      : ""
                    } py-2.5 rounded-tl-full rounded-bl-full transition-all duration-200 ease-in-out cursor-pointer ${isActive
                      ? "bg-background"
                      : "hover:bg-gray-300/10 active:bg-gray-300/20"
                    } relative overflow-visible`}
                >
                  {/* Background overlay for clipped-in rounded corners on adjacent items - matching active color */}
                  {/* {isBeforeActive && (
                    <div className="absolute -right-4 bottom-0 w-8 h-8 bg-white border-white">
                      <div className="absolute right-0 bottom-0 w-8 h-8 bg-primary rounded-br-full"></div>
                    </div>
                  )} */}
                  {/* {isAfterActive && (
                    <div className="absolute -right-4 top-0 w-8 h-8 bg-white border-white">
                      <div className="absolute right-0 top-0 w-8 h-8 bg-primary rounded-tr-full"></div>
                    </div>
                  )} */}

                  <div className="w-6 h-6 flex-shrink-0 relative z-10 flex items-center justify-center transition-all duration-200 ease-in-out">
                    {item.id === "dashboard" ? (
                      <svg
                        width="24"
                        height="24"
                        viewBox="0 0 30 30"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                        className={`${isActive ? "text-primary" : "text-background"}`}
                      >
                        <path
                          d="M17.75 11.5C17.3958 11.5 17.0992 11.38 16.86 11.14C16.6208 10.9 16.5008 10.6033 16.5 10.25V5.25C16.5 4.89583 16.62 4.59917 16.86 4.36C17.1 4.12083 17.3967 4.00083 17.75 4H25.25C25.6042 4 25.9012 4.12 26.1412 4.36C26.3812 4.6 26.5008 4.89667 26.5 5.25V10.25C26.5 10.6042 26.38 10.9013 26.14 11.1413C25.9 11.3813 25.6033 11.5008 25.25 11.5H17.75ZM5.25 16.5C4.89583 16.5 4.59917 16.38 4.36 16.14C4.12083 15.9 4.00083 15.6033 4 15.25V5.25C4 4.89583 4.12 4.59917 4.36 4.36C4.6 4.12083 4.89667 4.00083 5.25 4H12.75C13.1042 4 13.4013 4.12 13.6413 4.36C13.8813 4.6 14.0008 4.89667 14 5.25V15.25C14 15.6042 13.88 15.9013 13.64 16.1413C13.4 16.3813 13.1033 16.5008 12.75 16.5H5.25ZM17.75 26.5C17.3958 26.5 17.0992 26.38 16.86 26.14C16.6208 25.9 16.5008 25.6033 16.5 25.25V15.25C16.5 14.8958 16.62 14.5992 16.86 14.36C17.1 14.1208 17.3967 14.0008 17.75 14H25.25C25.6042 14 25.9012 14.12 26.1412 14.36C26.3812 14.6 26.5008 14.8967 26.5 15.25V25.25C26.5 25.6042 26.38 25.9012 26.14 26.1412C25.9 26.3812 25.6033 26.5008 25.25 26.5H17.75ZM5.25 26.5C4.89583 26.5 4.59917 26.38 4.36 26.14C4.12083 25.9 4.00083 25.6033 4 25.25V20.25C4 19.8958 4.12 19.5992 4.36 19.36C4.6 19.1208 4.89667 19.0008 5.25 19H12.75C13.1042 19 13.4013 19.12 13.6413 19.36C13.8813 19.6 14.0008 19.8967 14 20.25V25.25C14 25.6042 13.88 25.9012 13.64 26.1412C13.4 26.3813 13.1033 26.5008 12.75 26.5H5.25Z"
                          fill="currentColor"
                        />
                      </svg>
                    ) : item.id === "portfolio" ? (
                      <svg
                        width="24"
                        height="24"
                        viewBox="0 0 27 26"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                        className={`${isActive ? "text-primary" : "text-background"}`}
                      >
                        <path d="M22.5 16.3125C22.5 15.6458 22.3021 14.9792 21.9062 14.3125C21.5104 13.6458 20.9375 13.1667 20.1875 12.875L10.4375 9.00001L10 8.87501C9.85417 8.83335 9.6875 8.81251 9.5 8.81251H7.5V6.96876C7.5 6.5521 7.59375 6.16668 7.78125 5.81251C7.96875 5.45835 8.22917 5.16668 8.5625 4.93751L14.8125 0.468764C15.0417 0.302097 15.2762 0.182097 15.5163 0.108764C15.7563 0.0354306 16.0008 -0.000819288 16.25 1.4045e-05C16.4992 0.000847378 16.7492 0.0375141 17 0.110014C17.2508 0.182514 17.48 0.302097 17.6875 0.468764L23.9375 4.93751C24.2708 5.16668 24.5312 5.45835 24.7188 5.81251C24.9062 6.16668 25 6.5521 25 6.96876V16.3125H22.5ZM17.5 7.56251C17.6667 7.56251 17.8125 7.50001 17.9375 7.37501C18.0625 7.25001 18.125 7.10418 18.125 6.93751C18.125 6.77085 18.0625 6.62501 17.9375 6.50001C17.8125 6.37501 17.6667 6.31251 17.5 6.31251C17.3333 6.31251 17.1875 6.37501 17.0625 6.50001C16.9375 6.62501 16.875 6.77085 16.875 6.93751C16.875 7.10418 16.9375 7.25001 17.0625 7.37501C17.1875 7.50001 17.3333 7.56251 17.5 7.56251ZM15 7.56251C15.1667 7.56251 15.3125 7.50001 15.4375 7.37501C15.5625 7.25001 15.625 7.10418 15.625 6.93751C15.625 6.77085 15.5625 6.62501 15.4375 6.50001C15.3125 6.37501 15.1667 6.31251 15 6.31251C14.8333 6.31251 14.6875 6.37501 14.5625 6.50001C14.4375 6.62501 14.375 6.77085 14.375 6.93751C14.375 7.10418 14.4375 7.25001 14.5625 7.37501C14.6875 7.50001 14.8333 7.56251 15 7.56251ZM17.5 10.0625C17.6667 10.0625 17.8125 10 17.9375 9.87501C18.0625 9.75001 18.125 9.60418 18.125 9.43751C18.125 9.27085 18.0625 9.12501 17.9375 9.00001C17.8125 8.87501 17.6667 8.81251 17.5 8.81251C17.3333 8.81251 17.1875 8.87501 17.0625 9.00001C16.9375 9.12501 16.875 9.27085 16.875 9.43751C16.875 9.60418 16.9375 9.75001 17.0625 9.87501C17.1875 10 17.3333 10.0625 17.5 10.0625ZM15 10.0625C15.1667 10.0625 15.3125 10 15.4375 9.87501C15.5625 9.75001 15.625 9.60418 15.625 9.43751C15.625 9.27085 15.5625 9.12501 15.4375 9.00001C15.3125 8.87501 15.1667 8.81251 15 8.81251C14.8333 8.81251 14.6875 8.87501 14.5625 9.00001C14.4375 9.12501 14.375 9.27085 14.375 9.43751C14.375 9.60418 14.4375 9.75001 14.5625 9.87501C14.6875 10 14.8333 10.0625 15 10.0625ZM15.4688 24.8438C15.6979 24.9063 15.9637 24.9325 16.2662 24.9225C16.5687 24.9125 16.8237 24.8654 17.0312 24.7813L26.25 21.3125C26.25 20.6042 26 20.0104 25.5 19.5313C25 19.0521 24.4167 18.8125 23.75 18.8125H15.1875C15.125 18.8125 15.0521 18.8075 14.9688 18.7975C14.8854 18.7875 14.8229 18.7717 14.7812 18.75L12.9375 18.0938C12.7708 18.0313 12.6562 17.9271 12.5938 17.7813C12.5312 17.6354 12.5208 17.4792 12.5625 17.3125C12.6042 17.1667 12.7083 17.0521 12.875 16.9688C13.0417 16.8854 13.2083 16.875 13.375 16.9375L14.7812 17.4688C14.8646 17.5104 14.9325 17.5367 14.985 17.5475C15.0375 17.5583 15.1154 17.5633 15.2188 17.5625H18.5C18.8958 17.5625 19.2446 17.4271 19.5462 17.1563C19.8479 16.8854 19.9992 16.5313 20 16.0938C20 15.8021 19.9113 15.5208 19.7338 15.25C19.5563 14.9792 19.3221 14.7917 19.0312 14.6875L10.375 11.4688C10.2292 11.4271 10.0833 11.3904 9.9375 11.3588C9.79167 11.3271 9.64583 11.3117 9.5 11.3125H7.5V22.5938L15.4688 24.8438ZM0 22.5625C0 23.25 0.245 23.8388 0.735 24.3288C1.225 24.8188 1.81333 25.0633 2.5 25.0625C3.18667 25.0617 3.77542 24.8171 4.26625 24.3288C4.75708 23.8404 5.00167 23.2517 5 22.5625V13.8125C5 13.125 4.75542 12.5367 4.26625 12.0475C3.77708 11.5583 3.18833 11.3133 2.5 11.3125C1.81167 11.3117 1.22333 11.5567 0.735 12.0475C0.246667 12.5383 0.00166667 13.1267 0 13.8125V22.5625Z" fill="currentColor"/>
                      </svg>
                    ) : item.id === "applications" ? (
                      <svg
                        width="24"
                        height="24"
                        viewBox="0 0 30 30"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                        className={`${isActive ? "text-primary" : "text-background"}`}
                      >
                        <g clipPath="url(#clip0_app_icon)">
                          <path
                            d="M15.625 14.9375C16.2292 14.2708 16.6929 13.5104 17.0163 12.6562C17.3396 11.8021 17.5008 10.9167 17.5 10C17.4992 9.08333 17.3379 8.19792 17.0163 7.34375C16.6946 6.48958 16.2308 5.72917 15.625 5.0625C16.875 5.22917 17.9167 5.78125 18.75 6.71875C19.5833 7.65625 20 8.75 20 10C20 11.25 19.5833 12.3438 18.75 13.2812C17.9167 14.2188 16.875 14.7708 15.625 14.9375ZM21.8125 25C22.0417 24.625 22.2138 24.2242 22.3288 23.7975C22.4438 23.3708 22.5008 22.9383 22.5 22.5V21.25C22.5 20.5 22.3333 19.7862 22 19.1087C21.6667 18.4312 21.2292 17.8325 20.6875 17.3125C21.75 17.6875 22.7346 18.1721 23.6413 18.7662C24.5479 19.3604 25.0008 20.1883 25 21.25V22.5C25 23.1875 24.7554 23.7763 24.2663 24.2663C23.7771 24.7563 23.1883 25.0008 22.5 25H21.8125ZM25 13.75H23.75C23.3958 13.75 23.0992 13.63 22.86 13.39C22.6208 13.15 22.5008 12.8533 22.5 12.5C22.4992 12.1467 22.6192 11.85 22.86 11.61C23.1008 11.37 23.3975 11.25 23.75 11.25H25V10C25 9.64583 25.12 9.34917 25.36 9.11C25.6 8.87083 25.8967 8.75083 26.25 8.75C26.6033 8.74917 26.9004 8.86917 27.1412 9.11C27.3821 9.35083 27.5017 9.6475 27.5 10V11.25H28.75C29.1042 11.25 29.4012 11.37 29.6412 11.61C29.8812 11.85 30.0008 12.1467 30 12.5C29.9992 12.8533 29.8792 13.1504 29.64 13.3913C29.4008 13.6321 29.1042 13.7517 28.75 13.75H27.5V15C27.5 15.3542 27.38 15.6513 27.14 15.8913C26.9 16.1313 26.6033 16.2508 26.25 16.25C25.8967 16.2492 25.6 16.1292 25.36 15.89C25.12 15.6508 25 15.3542 25 15V13.75ZM10 15C8.625 15 7.44792 14.5104 6.46875 13.5312C5.48958 12.5521 5 11.375 5 10C5 8.625 5.48958 7.44792 6.46875 6.46875C7.44792 5.48958 8.625 5 10 5C11.375 5 12.5521 5.48958 13.5312 6.46875C14.5104 7.44792 15 8.625 15 10C15 11.375 14.5104 12.5521 13.5312 13.5312C12.5521 14.5104 11.375 15 10 15ZM0 22.5V21.5C0 20.7917 0.1825 20.1408 0.5475 19.5475C0.9125 18.9542 1.39667 18.5008 2 18.1875C3.29167 17.5417 4.60417 17.0575 5.9375 16.735C7.27083 16.4125 8.625 16.2508 10 16.25C11.375 16.2492 12.7292 16.4108 14.0625 16.735C15.3958 17.0592 16.7083 17.5433 18 18.1875C18.6042 18.5 19.0887 18.9533 19.4538 19.5475C19.8188 20.1417 20.0008 20.7925 20 21.5V22.5C20 23.1875 19.7554 23.7763 19.2663 24.2663C18.7771 24.7563 18.1883 25.0008 17.5 25H2.5C1.8125 25 1.22417 24.7554 0.735 24.2663C0.245833 23.7771 0.000833333 23.1883 0 22.5Z"
                            fill="currentColor"
                          />
                        </g>
                        <defs>
                          <clipPath id="clip0_app_icon">
                            <rect width="30" height="30" fill="white" />
                          </clipPath>
                        </defs>
                      </svg>
                    ) : item.id === "maintenance" ? (
                      <svg
                        width="24"
                        height="24"
                        viewBox="0 0 30 30"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                        className={`${isActive ? "text-primary" : "text-background"}`}
                      >
                        <path
                          d="M11.25 18.75C9.16667 18.75 7.39583 18.0208 5.9375 16.5625C4.47917 15.1042 3.75 13.3333 3.75 11.25C3.75 10.8333 3.78125 10.4167 3.84375 10C3.90625 9.58333 4.02083 9.1875 4.1875 8.8125C4.29167 8.60417 4.42208 8.44792 4.57875 8.34375C4.73542 8.23958 4.90708 8.16667 5.09375 8.125C5.28042 8.08333 5.47333 8.08875 5.6725 8.14125C5.87167 8.19375 6.05375 8.30292 6.21875 8.46875L9.5 11.75L11.75 9.5L8.46875 6.21875C8.30208 6.05208 8.19292 5.87 8.14125 5.6725C8.08958 5.475 8.08417 5.28208 8.125 5.09375C8.16583 4.90542 8.23875 4.73333 8.34375 4.5775C8.44875 4.42167 8.605 4.29167 8.8125 4.1875C9.1875 4.02083 9.58333 3.90625 10 3.84375C10.4167 3.78125 10.8333 3.75 11.25 3.75C13.3333 3.75 15.1042 4.47917 16.5625 5.9375C18.0208 7.39583 18.75 9.16667 18.75 11.25C18.75 11.7292 18.7083 12.1825 18.625 12.61C18.5417 13.0375 18.4167 13.4592 18.25 13.875L24.5625 20.125C25.1667 20.7292 25.4688 21.4688 25.4688 22.3438C25.4688 23.2188 25.1667 23.9583 24.5625 24.5625C23.9583 25.1667 23.2188 25.4688 22.3438 25.4688C21.4688 25.4688 20.7292 25.1562 20.125 24.5312L13.875 18.25C13.4583 18.4167 13.0367 18.5417 12.61 18.625C12.1833 18.7083 11.73 18.75 11.25 18.75Z"
                          fill="currentColor"
                        />
                      </svg>
                    ) : item.id === "insurance" ? (
                      <svg
                        width="30"
                        height="30"
                        viewBox="0 0 30 30"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                        className={`${isActive ? "text-primary" : "text-background"}`}
                      >
                        <path d="M12.5 20.3125C12.5 19.9583 12.62 19.6617 12.86 19.4225C13.1 19.1833 13.3967 19.0633 13.75 19.0625H16.25C16.6042 19.0625 16.9013 19.1825 17.1413 19.4225C17.3813 19.6625 17.5008 19.9592 17.5 20.3125V26.0625C17.5 26.2292 17.5729 26.3646 17.7188 26.4687C17.8646 26.5729 18.0208 26.5833 18.1875 26.5C19.6042 25.7083 20.8229 24.6929 21.8438 23.4538C22.8646 22.2146 23.625 20.8237 24.125 19.2812L15 12.2187L5.875 19.2812C6.375 20.8021 7.13042 22.1771 8.14125 23.4063C9.15208 24.6354 10.355 25.6458 11.75 26.4375C11.9167 26.5417 12.0833 26.5417 12.25 26.4375C12.4167 26.3333 12.5 26.1875 12.5 26V20.3125ZM5 8.28125V14.1875C5 14.5625 5.01583 14.9792 5.0475 15.4375C5.07917 15.8958 5.13625 16.3021 5.21875 16.6562L13.4687 10.25C13.9271 9.89583 14.4375 9.71875 15 9.71875C15.5625 9.71875 16.0729 9.89583 16.5313 10.25L24.7813 16.6562C24.8646 16.3021 24.9221 15.8958 24.9537 15.4375C24.9854 14.9792 25.0008 14.5625 25 14.1875V8.28125C25 7.76042 24.8487 7.29167 24.5462 6.875C24.2437 6.45833 23.8533 6.15625 23.375 5.96875L15.875 3.15625C15.5833 3.05208 15.2917 3 15 3C14.7083 3 14.4167 3.05208 14.125 3.15625L6.625 5.96875C6.14583 6.15625 5.75542 6.45833 5.45375 6.875C5.15208 7.29167 5.00083 7.76042 5 8.28125Z" fill="currentColor"/>
                      </svg>
                    ) : item.id === "rental-info" ? (
                      <svg
                        width="24"
                        height="24"
                        viewBox="0 0 44 36"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                        className={`${isActive ? "text-primary" : "text-background"}`}
                      >
                        <path d="M0 18.05C0 17.3833 0.15 16.7667 0.45 16.2C0.75 15.6333 1.16667 15.1667 1.7 14.8L11.7 7.65C12.0667 7.38333 12.442 7.19133 12.826 7.074C13.21 6.95667 13.6013 6.89867 14 6.9C14.3987 6.90133 14.7907 6.96 15.176 7.076C15.5613 7.192 15.936 7.38333 16.3 7.65L26.3 14.8C26.8333 15.1667 27.25 15.6333 27.55 16.2C27.85 16.7667 28 17.3833 28 18.05V32C28 33.1 27.6087 34.042 26.826 34.826C26.0433 35.61 25.1013 36.0013 24 36H22C20.9 36 19.9587 35.6087 19.176 34.826C18.3933 34.0433 18.0013 33.1013 18 32V27C18 26.1667 17.7087 25.4587 17.126 24.876C16.5433 24.2933 15.8347 24.0013 15 24H13C12.1667 24 11.4587 24.292 10.876 24.876C10.2933 25.46 10.0013 26.168 10 27V32C10 33.1 9.60867 34.042 8.826 34.826C8.04333 35.61 7.10133 36.0013 6 36H4C2.9 36 1.95867 35.6087 1.176 34.826C0.393333 34.0433 0.00133333 33.1013 0 32V18.05ZM44 4V32C44 33.1 43.6087 34.042 42.826 34.826C42.0433 35.61 41.1013 36.0013 40 36H34C33.4333 36 32.9587 35.808 32.576 35.424C32.1933 35.04 32.0013 34.5653 32 34V16.05C32 15.3833 31.858 14.7667 31.574 14.2C31.29 13.6333 30.882 13.1667 30.35 12.8L19.9 5.3C19.4667 4.96667 19.1167 4.56667 18.85 4.1C18.5833 3.63333 18.45 3.16667 18.45 2.7C18.45 1.86667 18.7167 1.20867 19.25 0.726C19.7833 0.243333 20.5 0.00133333 21.4 0H40C41.1 0 42.042 0.392 42.826 1.176C43.61 1.96 44.0013 2.90133 44 4ZM33 12H35C35.2667 12 35.5 11.9 35.7 11.7C35.9 11.5 36 11.2667 36 11V9C36 8.73333 35.9 8.5 35.7 8.3C35.5 8.1 35.2667 8 35 8H33C32.7333 8 32.5 8.1 32.3 8.3C32.1 8.5 32 8.73333 32 9V11C32 11.2667 32.1 11.5 32.3 11.7C32.5 11.9 32.7333 12 33 12ZM33 20H35C35.2667 20 35.5 19.9 35.7 19.7C35.9 19.5 36 19.2667 36 19V17C36 16.7333 35.9 16.5 35.7 16.3C35.5 16.1 35.2667 16 35 16H33C32.7333 16 32.5 16.1 32.3 16.3C32.1 16.5 32 16.7333 32 17V19C32 19.2667 32.1 19.5 32.3 19.7C32.5 19.9 32.7333 20 33 20ZM33 28H35C35.2667 28 35.5 27.9 35.7 27.7C35.9 27.5 36 27.2667 36 27V25C36 24.7333 35.9 24.5 35.7 24.3C35.5 24.1 35.2667 24 35 24H33C32.7333 24 32.5 24.1 32.3 24.3C32.1 24.5 32 24.7333 32 25V27C32 27.2667 32.1 27.5 32.3 27.7C32.5 27.9 32.7333 28 33 28Z" fill="currentColor"/>
                      </svg>
                    ) : item.id === "accounting" ? (
                      <svg
                        width="24"
                        height="24"
                        viewBox="0 0 30 30"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                        className={`${isActive ? "text-primary" : "text-background"}`}
                      >
                        <path d="M6.25 26.25C5.5625 26.25 4.97417 26.0054 4.485 25.5163C3.99583 25.0271 3.75083 24.4383 3.75 23.75V6.25C3.75 5.5625 3.995 4.97417 4.485 4.485C4.975 3.99583 5.56333 3.75083 6.25 3.75H23.75C24.4375 3.75 25.0263 3.995 25.5163 4.485C26.0063 4.975 26.2508 5.56333 26.25 6.25H16.25C14.7708 6.25 13.5679 6.71375 12.6412 7.64125C11.7146 8.56875 11.2508 9.77167 11.25 11.25V18.75C11.25 20.2292 11.7137 21.4325 12.6412 22.36C13.5687 23.2875 14.7717 23.7508 16.25 23.75H26.25C26.25 24.4375 26.0054 25.0263 25.5163 25.5163C25.0271 26.0063 24.4383 26.2508 23.75 26.25H6.25ZM16.25 21.25C15.5625 21.25 14.9742 21.0054 14.485 20.5163C13.9958 20.0271 13.7508 19.4383 13.75 18.75V11.25C13.75 10.5625 13.995 9.97417 14.485 9.485C14.975 8.99583 15.5633 8.75083 16.25 8.75H25C25.6875 8.75 26.2763 8.995 26.7663 9.485C27.2563 9.975 27.5008 10.5633 27.5 11.25V18.75C27.5 19.4375 27.2554 20.0263 26.7663 20.5163C26.2771 21.0063 25.6883 21.2508 25 21.25H16.25ZM20 16.875C20.5417 16.875 20.9896 16.6979 21.3438 16.3438C21.6979 15.9896 21.875 15.5417 21.875 15C21.875 14.4583 21.6979 14.0104 21.3438 13.6562C20.9896 13.3021 20.5417 13.125 20 13.125C19.4583 13.125 19.0104 13.3021 18.6562 13.6562C18.3021 14.0104 18.125 14.4583 18.125 15C18.125 15.5417 18.3021 15.9896 18.6562 16.3438C19.0104 16.6979 19.4583 16.875 20 16.875Z" fill="currentColor"/>
                      </svg>
                    ) : item.id === "leases" ? (
                      <svg
                        width="30"
                        height="30"
                        viewBox="0 0 30 30"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                        className={`${isActive ? "text-primary" : "text-background"}`}
                      >
                        <path d="M11.25 15.75H18.75C19.1042 15.75 19.4013 15.63 19.6413 15.39C19.8813 15.15 20.0008 14.8533 20 14.5C19.9992 14.1467 19.8792 13.85 19.64 13.61C19.4008 13.37 19.1042 13.25 18.75 13.25H11.25C10.8958 13.25 10.5992 13.37 10.36 13.61C10.1208 13.85 10.0008 14.1467 10 14.5C9.99917 14.8533 10.1192 15.1504 10.36 15.3913C10.6008 15.6321 10.8975 15.7517 11.25 15.75ZM11.25 19.5H18.75C19.1042 19.5 19.4013 19.38 19.6413 19.14C19.8813 18.9 20.0008 18.6033 20 18.25C19.9992 17.8967 19.8792 17.6 19.64 17.36C19.4008 17.12 19.1042 17 18.75 17H11.25C10.8958 17 10.5992 17.12 10.36 17.36C10.1208 17.6 10.0008 17.8967 10 18.25C9.99917 18.6033 10.1192 18.9004 10.36 19.1413C10.6008 19.3821 10.8975 19.5017 11.25 19.5ZM11.25 23.25H15C15.3542 23.25 15.6513 23.13 15.8913 22.89C16.1313 22.65 16.2508 22.3533 16.25 22C16.2492 21.6467 16.1292 21.35 15.89 21.11C15.6508 20.87 15.3542 20.75 15 20.75H11.25C10.8958 20.75 10.5992 20.87 10.36 21.11C10.1208 21.35 10.0008 21.6467 10 22C9.99917 22.3533 10.1192 22.6504 10.36 22.8912C10.6008 23.1321 10.8975 23.2517 11.25 23.25ZM7.5 27C6.8125 27 6.22417 26.7554 5.735 26.2663C5.24583 25.7771 5.00083 25.1883 5 24.5V4.5C5 3.8125 5.245 3.22417 5.735 2.735C6.225 2.24583 6.81333 2.00083 7.5 2H16.4688C16.8021 2 17.12 2.0625 17.4225 2.1875C17.725 2.3125 17.9904 2.48958 18.2188 2.71875L24.2812 8.78125C24.5104 9.01042 24.6875 9.27625 24.8125 9.57875C24.9375 9.88125 25 10.1987 25 10.5312V24.5C25 25.1875 24.7554 25.7763 24.2663 26.2663C23.7771 26.7563 23.1883 27.0008 22.5 27H7.5ZM16.25 9.5C16.25 9.85417 16.37 10.1513 16.61 10.3913C16.85 10.6313 17.1467 10.7508 17.5 10.75H22.5L16.25 4.5V9.5Z" fill="currentColor"/>
                      </svg>
                    ) : item.id === "analytics" ? (
                      <svg
                        width="23"
                        height="23"
                        viewBox="0 0 23 23"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                        className={`${isActive ? "text-primary" : "text-background"}`}
                      >
                        <path d="M6.25 11.25C5.89583 11.25 5.59917 11.37 5.36 11.61C5.12083 11.85 5.00083 12.1467 5 12.5V16.25C5 16.6042 5.12 16.9012 5.36 17.1412C5.6 17.3812 5.89667 17.5008 6.25 17.5C6.60333 17.4992 6.90042 17.3792 7.14125 17.14C7.38208 16.9008 7.50167 16.6042 7.5 16.25V12.5C7.5 12.1458 7.38 11.8492 7.14 11.61C6.9 11.3708 6.60333 11.2508 6.25 11.25ZM16.25 5C15.8958 5 15.5992 5.12 15.36 5.36C15.1208 5.6 15.0008 5.89667 15 6.25V16.25C15 16.6042 15.12 16.9012 15.36 17.1412C15.6 17.3812 15.8967 17.5008 16.25 17.5C16.6033 17.4992 16.9004 17.3792 17.1412 17.14C17.3821 16.9008 17.5017 16.6042 17.5 16.25V6.25C17.5 5.89583 17.38 5.59917 17.14 5.36C16.9 5.12083 16.6033 5.00083 16.25 5ZM11.25 13.75C10.8958 13.75 10.5992 13.87 10.36 14.11C10.1208 14.35 10.0008 14.6467 10 15V16.25C10 16.6042 10.12 16.9012 10.36 17.1412C10.6 17.3812 10.8967 17.5008 11.25 17.5C11.6033 17.4992 11.9004 17.3792 12.1413 17.14C12.3821 16.9008 12.5017 16.6042 12.5 16.25V15C12.5 14.6458 12.38 14.3492 12.14 14.11C11.9 13.8708 11.6033 13.7508 11.25 13.75ZM2.5 22.5C1.8125 22.5 1.22417 22.2554 0.735 21.7663C0.245833 21.2771 0.000833333 20.6883 0 20V2.5C0 1.8125 0.245 1.22417 0.735 0.735C1.225 0.245833 1.81333 0.000833333 2.5 0H20C20.6875 0 21.2763 0.245 21.7663 0.735C22.2563 1.225 22.5008 1.81333 22.5 2.5V20C22.5 20.6875 22.2554 21.2763 21.7663 21.7663C21.2771 22.2563 20.6883 22.5008 20 22.5H2.5ZM11.25 11.25C11.6042 11.25 11.9013 11.13 12.1413 10.89C12.3813 10.65 12.5008 10.3533 12.5 10C12.4992 9.64667 12.3792 9.35 12.14 9.11C11.9008 8.87 11.6042 8.75 11.25 8.75C10.8958 8.75 10.5992 8.87 10.36 9.11C10.1208 9.35 10.0008 9.64667 10 10C9.99917 10.3533 10.1192 10.6504 10.36 10.8913C10.6008 11.1321 10.8975 11.2517 11.25 11.25Z" fill="currentColor"/>
                      </svg>
                    ) : null}
                  </div>
                  {!isCollapsed && (
                    <span
                      className={`text-[16px] whitespace-nowrap relative z-10 transition-colors duration-200 ease-in-out ${isActive
                          ? "text-[#1F363D] dark:text-gray-100 font-semibold"
                          : "text-white dark:text-gray-300"
                        }`}
                    >
                      {item.label}
                    </span>
                  )}
                </button>
              );
            })}
          </nav>

        </div>

        {/* Bottom Section */}
        <div className="border-t border-gray-700 dark:border-gray-800 pt-4 mt-auto p-4 pr-0 space-y-2">
          <button
            onClick={() => navigate("/help-support")}
            className={`w-full flex items-center ${
              isCollapsed ? "justify-center px-0" : "space-x-3 px-3"
            } py-2.5 rounded-tl-full rounded-bl-full transition-all duration-200 ease-in-out cursor-pointer ${
              activeNav === "help-support"
                ? "bg-background"
                : "hover:bg-gray-300/10 active:bg-gray-300/20"
            } relative overflow-visible`}
          >
            <div className={`w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 relative z-10 transition-all duration-200 ease-in-out ${
              activeNav === "help-support"
                ? "bg-primary"
                : "bg-gray-300 hover:bg-gray-400 dark:bg-gray-700 dark:hover:bg-gray-600"
            }`}>
              <span className={`text-lg font-bold ${
                activeNav === "help-support"
                  ? "text-primary-foreground"
                  : "text-gray-900 dark:text-gray-100"
              }`}>?</span>
            </div>
            {!isCollapsed && <span className={`text-[16px] whitespace-nowrap relative z-10 ${
              activeNav === "help-support"
                ? "text-primary"
                : "text-white dark:text-gray-300"
            }`}>Help & Support</span>}
          </button>


          <button
            onClick={() => setLogoutOpen(true)}
            className={`w-full flex items-center ${
              isCollapsed ? "justify-center px-0" : "space-x-3 px-3"
            } py-2.5 rounded-tl-full rounded-bl-full transition-all duration-200 ease-in-out cursor-pointer hover:bg-gray-300/10 active:bg-gray-300/20 relative overflow-visible`}
          >
            <div className="w-6 h-6 flex-shrink-0 relative z-10 flex items-center justify-center transition-all duration-200 ease-in-out">
              <LogOut className="w-5 h-5 text-white dark:text-gray-300" />
            </div>
            {!isCollapsed && <span className="text-[16px] text-white dark:text-gray-300 whitespace-nowrap relative z-10">Logout</span>}
          </button>
        </div>
      </div>

      {/* Content wrapper with proper left margin on desktop */}
      <div
        className={`transition-all duration-300 ease-in-out lg:ml-[${isCollapsed ? "70px" : "220px"
          }]`}
      />

      {/* Logout confirmation */}
      <AlertDialog open={logoutOpen} onOpenChange={setLogoutOpen}>
        <AlertDialogContent className="w-[calc(100%-2rem)] max-w-[calc(100%-2rem)] sm:w-full sm:max-w-lg rounded-2xl sm:rounded-lg">
          <AlertDialogHeader>
            <AlertDialogTitle className="text-base sm:text-lg">Logout</AlertDialogTitle>
            <AlertDialogDescription className="text-sm">
              Are you sure you want to logout?
            </AlertDialogDescription>
          </AlertDialogHeader>
          <AlertDialogFooter>
            <AlertDialogCancel className="rounded-2xl text-xs sm:text-sm">Cancel</AlertDialogCancel>
            <AlertDialogAction className="rounded-2xl text-xs sm:text-sm" onClick={handleLogout}>Logout</AlertDialogAction>
          </AlertDialogFooter>
        </AlertDialogContent>
      </AlertDialog>
    </>
  );
};

export default Sidebar;
