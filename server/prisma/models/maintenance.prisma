model MaintenanceRequest {
  id          String              @id @default(cuid())
  listingId   String
  tenantId    String
  leaseId     String?
  title       String
  description String
  category    MaintenanceCategory
  status      MaintenanceStatus   @default(OPEN)
  priority    MaintenancePriority @default(MEDIUM)

  listing Listing            @relation(fields: [listingId], references: [id])
  tenant  User               @relation(fields: [tenantId], references: [id])
  lease   Lease?             @relation(fields: [leaseId], references: [id])
  images  MaintenanceImage[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([tenantId, createdAt])
  @@index([listingId, createdAt])
  @@index([status, priority, createdAt])
  @@index([category])
  @@index([createdAt])
}

model MaintenanceImage {
  id                   String @id @default(cuid())
  maintenanceRequestId String
  url                  String

  maintenanceRequest MaintenanceRequest @relation(fields: [maintenanceRequestId], references: [id], onDelete: Cascade)
  createdAt          DateTime           @default(now())

  @@index([maintenanceRequestId])
}
